<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<f:view xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:custom="http://manaty.net/custom" contentType="text/html"
	locale="#{localeSelector.currentLocale}">

	<ui:insert name="metadata" />

	<html>

<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8" />
	<title>MEVEO | Open Source Billing Platform</title>
	<link rel="shortcut icon" href="#{request.contextPath}/favicon.ico" />
	<link rel="stylesheet" type="text/css"
		href="#{request.contextPath}/stylesheet/theme.css" />
	<link rel="stylesheet" type="text/css"
		href="#{request.contextPath}/stylesheet/main.css" />

	<ui:insert name="head" />

	<!-- <a:loadScript src="resource://jquery.js" /> -->
	<script type="text/javascript"
		src="#{facesContext.externalContext.requestContextPath}/js/equalHeight.js"></script>
</h:head>
<h:body>
	<h:form>
		<script type="text/javascript">
			jQuery(function() {
				jQuery('.panels').equalHeights();
			});
		</script>
		<div id="admin-bar">
			<div id="logo">
			</div>

			<ul>
				<li><div class="top-bar-home"></div> <h:link
						outcome="/home.xhtml" value="#{messages['menutop.home']}"
						styleClass="headerLink" /></li>
				<li>
					<div class="top-bar-pass"></div> <h:link
						outcome="/changePassword.xhtml"
						value="#{messages['menutop.changePassword']}"
						rendered="#{identity.loggedIn}" styleClass="headerLink" />
				</li>
				<li>
					<div class="top-bar-logout"></div> <h:commandLink
						action="#{identity.logout}" value="#{messages['menutop.logout']}"
						rendered="#{identity.loggedIn}" styleClass="headerLink"
						immediate="true" />
				</li>
				<li class="right-part">
					<div class="top-bar-user"></div> <h:outputText
						value="#{messages['commons.connectedUsers']} : #{identity.user.user.userName} "
						rendered="#{identity.loggedIn}" />
				</li>
				<li><h:outputText
						value="#{messages['commons.connectedProvider']} : #{currentProvider.code}"
						rendered="#{identity.loggedIn and identity.user.user.onlyOneProvider}" />

					<h:link
						value="#{messages['commons.connectedProvider']} : #{currentProvider.code} wwss"
						onclick="dlg_providerSelectPopup.show(); return false;"
						rendered="#{identity.loggedIn and !identity.user.user.onlyOneProvider}" />
				</li>


			</ul>
		</div>
		<!--end of admin bar -->
		<div id="header">
			<div id="logo">
			</div>

			<div id="headerleft"></div>
			<div id="headerright"></div>
		</div>
	</h:form>

	<ui:insert name="navigation">
	</ui:insert>
	<div class="body">

		<ui:insert name="body" />

	</div>

	<div class="footer">MEVEO @VERSION_NUMBER@ @BUILD_NUMBER@</div>

	<p:ajaxStatus
		style="width:64px;height:64px;position:fixed;right:5px;bottom:5px">
		<f:facet name="start">
			<h:graphicImage library="img" name="loading.gif" />
		</f:facet>

		<f:facet name="complete">
			<h:outputText value="" />
		</f:facet>
	</p:ajaxStatus>



	<p:dialog id="providerSelectPopup"
		rendered="#{identity.loggedIn and ! identity.user.user.onlyOneProvider}"
		header="#{messages['provider.popup.header']}"
		widgetVar="dlg_providerSelectPopup"  modal="true"
		styleClass="form-dialog">
		<h:form id="providerSelectPopupForm">


			<p:dataTable var="provider" value="#{identity.user.user.providers.toArray()}">

				<p:column headerText="#{messages['businessEntity.code']}">
					<h:outputText value="#{provider.code}" />
				</p:column>

				<p:column headerText="#{messages['businessEntity.description']}">
					<h:outputText value="#{provider.description}" />
				</p:column>
				<p:column>
					<p:commandLink value="#{messages['commons.select']}"
						action="#{currentProviderBean.setCurrentProvider(provider)}"
						oncomplete="dlg_providerSelectPopup.hide()">
					</p:commandLink>
				</p:column>
			</p:dataTable>
		</h:form>
	</p:dialog>

</h:body>
	</html>




</f:view>
