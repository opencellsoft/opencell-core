<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:s="http://jboss.com/products/seam/taglib" xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://java.sun.com/jsf/html" xmlns:hftl="http://hftl.org" xmlns:hf="http://java.sun.com/jsf/composite/tags"
    xmlns:p="http://primefaces.org/ui" template="/layout/template.xhtml">

    <f:metadata>
        <!-- 		<f:event type="preRenderView" listener="#{cacheBean.preRenderView}" /> -->
    </f:metadata>

    <ui:define name="navigation">
        <ui:include src="/layout/navigation.xhtml" />
    </ui:define>


    <ui:define name="body">
        <p:panel styleClass="search-panel" header="#{messages['cache.caches']}">
            <p:messages />

            <h:form>
                <p:dataTable id="datatable_caches" var="cacheInfo" value="#{cacheBean.summaryOfCaches}" paginator="true" rows="10" resizableColumns="true"
                    paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}" rowsPerPageTemplate="5,10,15"
                    lazy="false" styleClass="custom-grid" rowIndexVar="rowIndex">
                    <p:column headerText="#{messages['cache.name']}" sortBy="#{cacheInfo['name']}">
                        <h:link outcome="cacheDetail" value="#{cacheInfo['name']}">
                            <f:param name="cacheName" value="#{cacheInfo['name']}" />
                        </h:link>
                    </p:column>
                    <p:column headerText="#{messages['cache.itemsInCache']}">
                        <h:outputText value="#{cacheInfo['count']}" />
                    </p:column>
                    <p:column style="width: 100px;" headerText="#{messages['commons.actions']}">
                        <!--                         <p:tooltip for="viewlink" value="#{messages['commons.view']}" showEffect="slide" hideEffect="slide" /> -->
                        <!--                         <p:button id="viewlink" outcome="cacheDetail" icon="ui-icon-search"> -->
                        <!--                             <f:param name="cacheName" value="#{cacheInfo['name']}" /> -->
                        <!--                         </p:button> -->

                        <p:tooltip for="refreshlink" value="#{messages['cache.reload']}" showEffect="slide" hideEffect="slide" />
                        <p:commandButton id="refreshlink" icon="ui-icon-refresh" onclick="PF('confirmRefreshWidget#{rowIndex}').show()" type="button" />

                        <p:confirmDialog styleClass="confirm-dialog" message="#{messages['cache.confirmReload']}" header="" severity="alert"
                            widgetVar="confirmRefreshWidget#{rowIndex}">
                            <p:panel styleClass="confirm-dialog-content">
                                <p:commandButton id="refreshOk" value="#{messages['commons.yes']}" oncomplete="PF('confirmRefreshWidget#{rowIndex}').hide()"
                                    action="#{cacheBean.refresh(cacheInfo['name'])}" update="@all" />
                                <p:commandButton id="refreshKo" value="#{messages['commons.no']}" onclick="PF('confirmRefreshWidget#{rowIndex}').hide()" type="button" />
                            </p:panel>
                        </p:confirmDialog>
                    </p:column>
                </p:dataTable>

                <p:commandButton value="#{messages['commons.refresh']}" update="@all" />

                <p:commandButton value="#{messages['cache.reload']}" onclick="PF('confirmRefreshAllWidget').show()" type="button" />

                <p:confirmDialog styleClass="confirm-dialog" message="#{messages['cache.confirmReloadAll']}" header="" severity="alert" widgetVar="confirmRefreshAllWidget">
                    <p:panel styleClass="confirm-dialog-content">
                        <p:commandButton id="refreshOk" value="#{messages['commons.yes']}" oncomplete="PF('confirmRefreshAllWidget').hide()"
                            action="#{cacheBean.refresh(null)}" update="@all" />
                        <p:commandButton id="refreshKo" value="#{messages['commons.no']}" onclick="PF('confirmRefreshAllWidget').hide()" type="button" />
                    </p:panel>
                </p:confirmDialog>
            </h:form>
        </p:panel>
    </ui:define>

</ui:composition>